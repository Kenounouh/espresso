"use strict";(self.webpackChunkespresso=self.webpackChunkespresso||[]).push([[549],{730:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return m},default:function(){return h},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return p}});var a=n(7462),o=n(3366),i=(n(7294),n(3905)),s=n(5710),r=n(4996),c=["components"],l={title:"Magnetic system: bulk iron",sidebar_label:"Fe (magnetic)"},m=void 0,u={unversionedId:"hands-on/fe",id:"hands-on/fe",title:"Magnetic system: bulk iron",description:"I am following this example from the [ICTP online school 2021](",source:"@site/docs/hands-on/fe.mdx",sourceDirName:"hands-on",slug:"/hands-on/fe",permalink:"/espresso/hands-on/fe",draft:!1,editUrl:"https://github.com/pranabdas/espresso/blob/main/docs/hands-on/fe.mdx",tags:[],version:"current",frontMatter:{title:"Magnetic system: bulk iron",sidebar_label:"Fe (magnetic)"},sidebar:"docs",previous:{title:"GaAs",permalink:"/espresso/hands-on/GaAs"},next:{title:"Ni (spin pol. bands)",permalink:"/espresso/hands-on/ni"}},d={},p=[{value:"Convergence test for USPP",id:"convergence-test-for-uspp",level:2},{value:"Density of states calculation",id:"density-of-states-calculation",level:2},{value:"Paramagnetism",id:"paramagnetism",level:2},{value:"Visualizing magnetic moments",id:"visualizing-magnetic-moments",level:2}],f={toc:p};function h(e){var t=e.components,l=(0,o.Z)(e,c);return(0,i.kt)("wrapper",(0,a.Z)({},f,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"I am following this example from the ",(0,i.kt)("a",{parentName:"p",href:"https://gitlab.com/QEF/materials-for-max-qe2021-online-school"},"ICTP online school 2021"),"."),(0,i.kt)("p",null,"We will perform the SCF KS orbital calculations on magnetic (",(0,i.kt)("inlineCode",{parentName:"p"},"nspin=2"),") iron.\nSince the d-orbitals of Fe atom are localized/ hard, we will use ultra-soft\npseudo potential (USPP)."),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"If we have crystal structure with only one atom per unit cell, or only one type\nof atoms, the only possible ordering is ferromagnetic. In such cases, we need to\nform supercell with more number of atoms or label multiple atoms separately, so\nthat their magnetic orientation could be different thus having the possibility\nof ferro- or antiferromagnetic final states."))),(0,i.kt)("p",null,"Run the SCF calculations for both ferro- and antiferromagnetic structures.\nNotice that for ferromagnetic, we have BCC structure with only one type of atom,\nwhile we use simple cubic structure for antiferromagnetic case with two\ndifferent atomic labels. For antiferromagnetic calculation, we need to start\nwith opposite initial spins."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"pw.x -i pw.scf.fe_fm.in > pw.scf.fe_fm.out\npw.x -i pw.scf.fe_afm.in > pw.scf.fe_afm.out\n")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"In case of the AFM calculation, if we have started with FM (say, for both atom\ntypes ",(0,i.kt)("inlineCode",{parentName:"p"},"starting_magnetization=0.6")," ), the calculation would still converge to\nAFM state as it is the true ground state for this system, albeit it would take\nmore iteration to converge. If you get different results due to different\nstarting magnetization, you might need a stricter convergence criteria."))),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"In case of ultrasoft pseudo potentials, the Quantum Espresso default of\n",(0,i.kt)("inlineCode",{parentName:"p"},"ecutrho")," 4 times of ",(0,i.kt)("inlineCode",{parentName:"p"},"ecutoff")," is not sufficient. We need to set ",(0,i.kt)("inlineCode",{parentName:"p"},"ecutrho")," 8 or\neven 12 times that of ",(0,i.kt)("inlineCode",{parentName:"p"},"ecutoff"),". We must test the convergence for our set\nvalues."))),(0,i.kt)("h2",{id:"convergence-test-for-uspp"},"Convergence test for USPP"),(0,i.kt)("p",null,"Below is the PWTK script file:"),(0,i.kt)(s.Z,{language:"bash",title:"src/fe/fe_ecut.pwtk",showLineNumbers:!0,mdxType:"CodeBlock"},'# load the pw.x input from file\nload_fromPWI fe_scf_fm.in\n\n# dual is the ratio ecutrho/ecutwfc\nforeach dual { 4 8 12 } {\n\n    set fid [open etot-vs-ecutwfc.dual$dual.dat w]\n\n    foreach ecutwfc [seq 25 5 50] {\n\n        set name pw.Fe.scf.ecutwfc-$ecutwfc.dual-$dual\n\n        SYSTEM "ecutwfc = $ecutwfc\n                ecutrho = $ecutwfc*$dual "\n        runPW $name.in\n\n        set Etot [pwo_totene $name.out]\n        puts $fid "$ecutwfc $Etot"\n    }\n\n    close $fid\n}\n'),(0,i.kt)("p",null,"Run the script:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"pwtk fe_ecut.pwtk\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Fe convergence",src:n(6873).Z,width:"873",height:"553"})),(0,i.kt)("h2",{id:"density-of-states-calculation"},"Density of states calculation"),(0,i.kt)("p",null,"PWTK script to calculate DOS and p-DOS:"),(0,i.kt)(s.Z,{language:"bash",title:"src/fe/fe_dos.pwtk",showLineNumbers:!0,mdxType:"CodeBlock"},"load_fromPWI fe_scf_fm.in\n\nSYSTEM \" ecutwfc = 40\n         ecutrho = 320 \"\n\nset name Fe\n\nrunPW pw.$name.scf.in\n\nCONTROL { calculation = 'nscf' }\nSYSTEM  { occupations = 'tetrahedra' ,\n          degauss = ,  ! this is how variable is unset in PWTK\n}\nK_POINTS automatic {\n    12 12 12   1 1 1\n}\nrunPW pw.$name.nscf.in\n\nDOS \"\n    fildos = '$name.dos.dat'\n    Emin = 5.0\n    Emax = 20.0,\n    DeltaE = 0.1\n\"\nrunDOS dos.$name.in\n\nPROJWFC \"\n    filpdos = '$name.pdos.dat'\n    Emin = 5.0\n    Emax = 20.0,\n    DeltaE = 0.1\n\"\nrunPROJWFC projwfc.$name.in\n"),(0,i.kt)("p",null,"Below is the plots of total and projected density of states."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"density of states",src:n(9515).Z,width:"769",height:"545"})),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"projected density of states",src:n(5147).Z,width:"769",height:"545"})),(0,i.kt)("p",null,"Also see bandstructure of Fe with and without ",(0,i.kt)("a",{parentName:"p",href:"soc#bandstructure-of-fe-with-soc"},"SOC"),"."),(0,i.kt)("h2",{id:"paramagnetism"},"Paramagnetism"),(0,i.kt)("p",null,"Paramagnetic materials have fluctuating magnetic moments that may not be\nproperly described DFT. One approach is to model paramagnetic materials in DFT\ncalculation by building a large supercell and assign randomly oriented magnetic\nmoments."),(0,i.kt)("p",null,"Also note that DFT assumes zero temperature, so it makes sense to perform FM or\nAFM calculation for magnetic systems."),(0,i.kt)("h2",{id:"visualizing-magnetic-moments"},"Visualizing magnetic moments"),(0,i.kt)("p",null,"We can use ",(0,i.kt)("a",{parentName:"p",href:"http://www.xcrysden.org"},"XCrySDen")," to visualize the orientation of\nmagnetic moments. XCrySDen cannot directly read the Quantum Espresso output\nfiles for magnetic moment vectors, instead we need to create the input ",(0,i.kt)("inlineCode",{parentName:"p"},".xsf"),"\nfile with magnetic moments as force vector. You can also change the background\ncolor from black from the Palette Menu which is located in the left of File\nmenu."),(0,i.kt)(s.Z,{language:"bash",title:"src/fe/fe.xsf",showLineNumbers:!0,mdxType:"CodeBlock"},"# this is a specification for crystal structure\nCRYSTAL\n\n# primitive lattice vectors (in Angstroms)\nPRIMVEC\n    2.8681404710    0.0000000000    0.0000000000\n    0.0000000000    2.8681404710    0.0000000000\n    0.0000000000    0.0000000000    2.8681404710\n\n# conventional lattice vectors (in Angstroms)\nCONVVEC\n    2.8681404710    0.0000000000    0.0000000000\n    0.0000000000    2.8681404710    0.0000000000\n    0.0000000000    0.0000000000    2.8681404710\n\n# First number stands for number of atoms in primitive cell\n# the second number is always 1 for PRIMCOORD coordinates\n# followed by atomic coordinates (in Angstroms) and forces:\n# AtNum   X Y Z   Fx Fy Fz\nPRIMCOORD\n 2  1\n 26  0.0000000000  0.0000000000  0.0000000000    0.00  0.00  0.01\n 26  1.4340702350  1.4340702350  1.4340702350    0.00  0.00 -0.01\n"),(0,i.kt)("p",null,"Open the file from XCrySDen Menu: ",(0,i.kt)("strong",{parentName:"p"},"File \u2192 Open Structure \u2192 Open XSF"),". Then go\nto ",(0,i.kt)("strong",{parentName:"p"},"Display")," menu and select ",(0,i.kt)("strong",{parentName:"p"},"Forces"),". If you want to adjust scaling for the\nforce vectors, go to ",(0,i.kt)("strong",{parentName:"p"},"Modify \u2192 Force Settings")," and set suitable Length factor."),(0,i.kt)("img",{src:(0,r.Z)("/img/fe-magnetic-structure.png"),alt:"fe-magnetic-structure",width:"450px"}))}h.isMDXComponent=!0},6873:function(e,t,n){t.Z=n.p+"assets/images/fe-convergence-2aefca15b3e0939d06ca680afb8a71a1.png"},9515:function(e,t,n){t.Z=n.p+"assets/images/fe-dos-27c1fcc8eaec7d396fa1bc74be579cc2.png"},5147:function(e,t,n){t.Z=n.p+"assets/images/fe-pdos-776c198dd46078519795539284ddfcd0.png"}}]);